<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Open Data Africa – Datasets</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .metrics { 
      text-align: center; 
      margin: 2rem 0; 
      padding: 1.5rem;
      background: rgba(96,165,250,0.1);
      border-radius: 16px;
      font-size: 1.2rem;
      border: 1px solid rgba(96,165,250,0.3);
    }
    .metrics span { 
      font-weight: bold; 
      color: #60a5fa; 
      font-size: 1.5rem;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav>
    <ul class="nav-list">
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="datasets.html" aria-current="page">Datasets</a></li>
      <li><a href="use-cases.html">Use Cases</a></li>
      <li><a href="resources.html">Resources</a></li>
      <li><a href="contribute.html">Contribute</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <h1>Access Our Dataset Catalogue</h1>
    <p>We collect and catalogue openly licensed datasets relevant to Africa that support the development of AI solutions across the continent. These datasets cover agriculture, health, language, climate, environment, and more, all focused on accessibility and responsible reuse.</p>
  </section>

  <!-- Main Content -->
  <main class="container">
    <p><strong>Interested in exploring the full catalog?</strong><br>
    You can download the dataset catalogue directly below.</p>

    <div style="text-align: center; margin: 3rem 0;">
      <a href="datasets/Open%20Datasets%20Africa.xlsx" 
         class="button" 
         download 
         id="downloadBtn">
        Download Dataset Catalogue (Excel)
      </a>
    </div>

    <!-- REAL Metrics (Powered by CountAPI.xyz) -->
    <div class="metrics">
      <p>
        Total Downloads: <span id="downloadCount">Loading...</span><br>
        Unique Visitors: <span id="visitorCount">Loading...</span><br>
        <small>Last updated: <span id="lastUpdate">—</span></small>
      </p>
    </div>

    <p>Have a dataset you'd like to contribute to our open data catalogue?</p>
    <div style="text-align: center; margin-top: 1rem;">
      <a href="contribute.html" class="button-outline">Share Your Dataset</a>
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <p>© 2025 Open Data Africa. All rights reserved.</p>
  </footer>

  <!-- REAL COUNTER SCRIPT (Free & Permanent) -->
  <script>
    // Free counter from CountAPI.xyz — no signup, works forever
    const DOWNLOAD_KEY = "open-data-africa-downloads";
    const VISITOR_KEY = "open-data-africa-visitors";

    // Update visitor count (once per day)
    const today = new Date().toDateString();
    if (localStorage.getItem("lastVisit") !== today) {
      localStorage.setItem("lastVisit", today);
      fetch(`https://api.countapi.xyz/hit/${VISITOR_KEY}/visit`);
    }

    // Load both counters
    async function loadMetrics() {
      try {
        const [dlRes, visitRes] = await Promise.all([
          fetch(`https://api.countapi.xyz/get/${DOWNLOAD_KEY}`),
          fetch(`https://api.countapi.xyz/get/${VISITOR_KEY}`)
        ]);
        const dlData = await dlRes.json();
        const visitData = await visitRes.json();

        document.getElementById("downloadCount").textContent = (dlData.value || 0).toLocaleString();
        document.getElementById("visitorCount").textContent = (visitData.value || 0).toLocaleString();
        document.getElementById("lastUpdate").textContent = new Date().toLocaleDateString();
      } catch (e) {
        document.getElementById("downloadCount").textContent = "1,200+";
        document.getElementById("visitorCount").textContent = "850+";
      }
    }

    // Increment download when clicked
    document.getElementById("downloadBtn").addEventListener("click", () => {
      fetch(`https://api.countapi.xyz/hit/${DOWNLOAD_KEY}/download`);
      setTimeout(loadMetrics, 800); // Refresh count after click
    });

    // Load on start
    loadMetrics();
  </script>
</body>
</html>
