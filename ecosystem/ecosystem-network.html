<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>African AI Ecosystem — 3D Globe</title>
  <script src="https://unpkg.com/globe.gl"></script>
  <style>
    body { margin:0; background:#000; overflow:hidden; }
    #globe { width:100vw; height:100vh; }
    
    .title {
      position:absolute; top:20px; left:50%; transform:translateX(-50%);
      color:#60a5fa; font-size:3.5rem; font-weight:bold; z-index:10;
      text-shadow:0 0 30px #60a5fa, 0 0 60px #60a5fa;
      letter-spacing:2px;
    }
    
    .controls {
      position:absolute; top:20px; right:20px; background:rgba(0,0,0,0.7);
      padding:1.2rem; border-radius:20px; z-index:10; backdrop-filter:blur(20px);
      border:1px solid rgba(96,165,250,0.3);
    }
    .btn {
      background:linear-gradient(45deg,#60a5fa,#a5b4fc); color:#000;
      border:none; padding:0.9rem 1.8rem; border-radius:15px; cursor:pointer;
      font-weight:bold; font-size:1rem; margin:0.5rem 0; width:100%;
      box-shadow:0 8px 20px rgba(96,165,250,0.4);
    }
    .btn:hover { transform:scale(1.05); box-shadow:0 12px 30px rgba(96,165,250,0.6); }
    
    .info {
      position:absolute; bottom:20px; left:20px; background:rgba(0,0,0,0.7);
      padding:1.5rem 2rem; border-radius:20px; color:#e2e8f0; max-width:420px;
      backdrop-filter:blur(20px); border:1px solid rgba(96,165,250,0.3);
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
    }
  </style>
</head>
<body>

  <div class="title">AFRICAN AI ECOSYSTEM</div>

  <div class="controls">
    <button class="btn" id="toggleRotate">Pause Rotation</button>
  </div>

  <div id="globe"></div>

  <div class="info">
    <strong>Click any glowing dot → Visit startup</strong><br>
    Drag to explore • Scroll to zoom • Click "Pause" to stop rotation
  </div>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    const CSV_PATH = "https://open-data-africa.github.io/datasets/Ecosystem.csv";

    const globe = Globe()
      .globeImageUrl('//unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
      .bumpImageUrl('//unpkg.com/three-globe/example/img/earth-topology.png')
      .backgroundImageUrl('//unpkg.com/three-globe/example/img/night-sky.png')
      .showAtmosphere(true)
      .atmosphereColor('#60a5fa')
      .atmosphereAltitude(0.25)
      (document.getElementById('globe'));

    Papa.parse(CSV_PATH, {
      download: true,
      header: true,
      complete: function(res) {
        const data = res.data.filter(r => r.Name && r.Country);

        const coords = {
          "Kenya": [-1.29, 36.82], "Ethiopia": [9.02, 38.75], "Nigeria": [9.08, 7.40],
          "Ghana": [7.95, -1.02], "South Africa": [-30.56, 22.94], "Rwanda": [-1.94, 29.87],
          "Cameroon": [3.85, 11.50], "Tunisia": [36.82, 10.17], "Egypt": [26.82, 30.80],
          "Pan-Africa": [6, 20]
        };

        // RAINBOW COLORS BY TYPE — small & elegant
        const typeColor = {
          "Startup": "#FF6B6B",
          "Research Lab": "#A55EEA",
          "Research Institute": "#C56CF0",
          "Platform": "#4ECDC4",
          "Community": "#96CEB4",
          "Innovation Hub": "#FECA57",
          "Education Institute": "#FF9FF3",
          "Program": "#54A0FF",
          "default": "#60A5FA"
        };

        const points = data.map(org => {
          const t = (org.Type || "").trim();
          return {
            lat: coords[org.Country]?.[0] || 6,
            lng: coords[org.Country]?.[1] || 20,
            size: 0.8,                    // ← Small & elegant
            color: typeColor[t] || typeColor.default,
            name: org.Name,
            type: t,
            domain: org.Domain,
            website: org.Website,
            country: org.Country
          };
        });

        globe
          .pointsData(points)
          .pointAltitude(0.03)           // ← Lower height = cleaner look
          .pointColor(d => d.color)
          .pointRadius(d => d.size)      // ← Tiny, beautiful dots
          .pointLabel(d => `
            <div style="background:rgba(0,0,0,0.9); padding:12px; border-radius:12px; border:2px solid ${d.color}; min-width:200px; font-size:0.9rem;">
              <b style="color:${d.color}; font-size:1.1rem;">${d.name}</b><br>
              ${d.type} • ${d.domain}<br>
              <i>${d.country}</i>
            </div>
          `)
          .onPointClick(point => window.open(point.website, '_blank'));

        // Auto-rotate + pause button
        globe.controls().autoRotate = true;
        globe.controls().autoRotateSpeed = 0.6;

        document.getElementById('toggleRotate').addEventListener('click', function() {
          const rotating = globe.controls().autoRotate;
          globe.controls().autoRotate = !rotating;
          this.textContent = rotating ? "Resume Rotation" : "Pause Rotation";
        });
      }
    });
  </script>
</body>
</html>
