<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>African AI Ecosystem — Network</title>
  <script src="https://unpkg.com/vis-network@9.1.2/standalone/umd/vis-network.min.js"></script>
  <style>
    :root { --bg:#0f172a; --card:#1e293b; --text:#e2e8f0; --accent:#60a5fa; }
    body { margin:0; font-family:'Segoe UI',sans-serif; background:var(--bg); color:var(--text); height:100vh; }
    header { background:linear-gradient(135deg,#1e293b,#0f172a); padding:3rem 1rem; text-align:center; }
    h1 { margin:0; font-size:2.8rem; color:var(--accent); }
    nav { background:#1e293b; padding:1rem; text-align:center; }
    nav a { color:var(--accent); margin:0 .8rem; text-decoration:none; }
    #network { height:80vh; width:100%; border-radius:16px; background:#0f172a; }
    .details { max-width:700px; margin:2rem auto; background:var(--card); padding:2rem; border-radius:16px; display:none; }
    .org { background:rgba(255,255,255,0.05); padding:1rem; border-radius:12px; margin:1rem 0; }
    .org strong { color:var(--accent); }
  </style>
</head>
<body>

  <header>
    <h1>African AI Ecosystem</h1>
    <p style="opacity:0.9;">Interactive Network — Click any country to explore</p>
  </header>

  <nav>
    <a href="ecosystem-overview.html">Overview</a> •
    <a href="ecosystem-map.html">Map</a> •
    <a href="ecosystem-readiness.html">Readiness</a> •
    <a href="ecosystem-network.html">Network</a> •
    <a href="ecosystem-investor.html">Investor Briefs</a>
  </nav>

  <div id="network"></div>

  <div class="details" id="details">
    <h2 id="title" style="color:var(--accent);"></h2>
    <div id="orgs"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    const CSV_PATH = "https://open-data-africa.github.io/datasets/Ecosystem.csv";

    Papa.parse(CSV_PATH, {
      download: true,
      header: true,
      complete: function(res) {
        const data = res.data.filter(r => r.Name && r.Name.trim());

        const countryMap = {};
        data.forEach(org => {
          const c = (org.Country || "Other").trim();
          if (!countryMap[c]) countryMap[c] = { orgs: [], types: {} };
          countryMap[c].orgs.push(org);
          const t = (org.Type || "Other").trim();
          countryMap[c].types[t] = (countryMap[c].types[t] || 0) + 1;
        });

        const nodes = [];
        const edges = [];

        Object.entries(countryMap).forEach(([country, info], i) => {
          const dominantType = Object.entries(info.types).sort((a,b) => b[1]-a[1])[0][0];
          const color = {
            "Startup": "#FF6B6B",
            "Research Lab": "#A55EEA",
            "Research Institute": "#C56CF0",
            "Platform": "#4ECDC4",
            "Community": "#96CEB4",
            "Innovation Hub": "#FECA57",
            "Education Institute": "#96CEB4",
            "Program": "#FF9FF3"
          }[dominantType] || "#54A0FF";

          nodes.push({
            id: country,
            label: `${country}\n${info.orgs.length} org${info.orgs.length>1?'s':''}`,
            size: 25 + info.orgs.length * 12,
            color: { background: color, border: "#fff", highlight: { background: "#a5b4fc" } },
            font: { color: "#e2e8f0", size: 16, strokeWidth: 4, strokeColor: "#0f172a" },
            shape: "dot",
            orgs: info.orgs
          });
        });

        const container = document.getElementById("network");
        const dataNet = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };

        new vis.Network(container, dataNet, {
          physics: { enabled: false },
          layout: { improvedLayout: true },
          nodes: { shape: "dot", font: { align: "center" } },
          interaction: { hover: true, zoomView: true, dragView: true }
        }).on("click", params => {
          if (params.nodes.length) {
            const country = params.nodes[0];
            const info = countryMap[country];
            document.getElementById("title").textContent = `${country} — ${info.orgs.length} organization${info.orgs.length>1?'s':''}`;
            document.getElementById("orgs").innerHTML = info.orgs.map(o => `
              <div class="org">
                <strong>${o.Name}</strong><br>
                <small>${o.Type} • ${o.Domain}</small><br>
                ${o.Website ? `<a href="${o.Website}" target="_blank">Visit Website</a>` : ""}
              </div>
            `).join("");
            document.getElementById("details").style.display = "block";
          } else {
            document.getElementById("details").style.display = "none";
          }
        });
      }
    });
  </script>
</body>
</html>
