<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Use Cases â€“ Open Data Africa</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

  <!-- Navigation -->
  <nav>
    <ul class="nav-list">
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="datasets.html">Datasets</a></li>
      <li><a href="use-cases.html" aria-current="page">Use Cases</a></li>
      <li><a href="resources.html">Resources</a></li>
      <li><a href="contribute.html">Contribute</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
  </nav>

  <main class="container">
    <h1>Explore Use Cases</h1>

    <!-- Filters -->
    <div class="filters">
      <input type="text" id="searchInput" placeholder="Search use cases..." />
      <select id="domainFilter">
        <option value="">All Domains</option>
      </select>
      <select id="countryFilter">
        <option value="">All Countries</option>
      </select>
    </div>

    <!-- Card Container -->
    <div id="useCasesContainer" class="card-grid">
      <!-- Cards will be dynamically inserted here -->
    </div>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      Papa.parse("datasets/catalog.csv", {
        download: true,
        header: true,
        complete: function (results) {
          const data = results.data;

          const domainSet = new Set();
          const countrySet = new Set();

          // Populate filters
          data.forEach(row => {
            if (row.Domain) domainSet.add(row.Domain.trim());
            if (row.Country) countrySet.add(row.Country.trim());
          });

          const domainFilter = document.getElementById("domainFilter");
          const countryFilter = document.getElementById("countryFilter");

          [...domainSet].sort().forEach(domain => {
            domainFilter.innerHTML += `<option value="${domain}">${domain}</option>`;
          });

          [...countrySet].sort().forEach(country => {
            countryFilter.innerHTML += `<option value="${country}">${country}</option>`;
          });

          function renderCards(filterText = "", domain = "", country = "") {
            const container = document.getElementById("useCasesContainer");
            container.innerHTML = "";

            data.forEach(row => {
              const matchesSearch = row["Use Cases"]?.toLowerCase().includes(filterText.toLowerCase());
              const matchesDomain = !domain || row.Domain === domain;
              const matchesCountry = !country || row.Country === country;

              if (matchesSearch && matchesDomain && matchesCountry) {
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `
                  <h3>${row["Dataset Name"] || "Unnamed Dataset"}</h3>
                  <p><strong>Use Case:</strong> ${row["Use Cases"] || "N/A"}</p>
                  <p><strong>Domain:</strong> ${row.Domain || "N/A"}</p>
                  <p><strong>Country:</strong> ${row.Country || "N/A"}</p>
                  <p><strong>Data Type:</strong> ${row["Data Type"] || "N/A"}</p>
                  <p><strong>Access:</strong> ${row["License"] || "N/A"}</p>
                `;
                container.appendChild(card);
              }
            });
          }

          renderCards();

          // Event Listeners
          document.getElementById("searchInput").addEventListener("input", e => {
            renderCards(e.target.value, domainFilter.value, countryFilter.value);
          });

          domainFilter.addEventListener("change", () => {
            renderCards(searchInput.value, domainFilter.value, countryFilter.value);
          });

          countryFilter.addEventListener("change", () => {
            renderCards(searchInput.value, domainFilter.value, countryFilter.value);
          });
        }
      });
    });
  </script>

  <style>
    .filters {
      margin: 1rem 0;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .filters input, .filters select {
      padding: 8px;
      font-size: 1rem;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
    }
    .card {
      background: #f4f4f4;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
  </style>

</body>
</html>
